# TPM 라인별 고장 분석 가이드

## 📊 파이 차트 해석 방법

### 기존 문제점
이전 버전에서는 파이 차트에 마우스를 올렸을 때 `1:12`, `0:5`, `2:6` 같은 숫자만 표시되어 혼란스러웠습니다.

**의미:**
- `0:5` → 데이터 배열의 0번째 항목 (A 라인): 5건
- `1:12` → 데이터 배열의 1번째 항목 (B 라인): 12건
- `2:6` → 데이터 배열의 2번째 항목 (C 라인): 6건

### ✅ 개선된 툴팁

이제 마우스를 올리면 다음과 같이 명확하게 표시됩니다:

```
┌─────────────────────┐
│ B 라인              │
│ 고장 건수: 12건     │
│ 비율: 52%           │
└─────────────────────┘
```

### 차트 구성 요소

#### 1. **파이 조각 (Pie Slice)**
- **파란색**: A 라인 (5건, 22%)
- **빨간색**: B 라인 (12건, 52%) ← 가장 문제가 많음
- **노란색**: C 라인 (6건, 26%)

#### 2. **차트 내 라벨**
```
A 라인: 22%
B 라인: 52%
C 라인: 26%
```

#### 3. **하단 범례 (Legend)**
```
● A 라인 (5건)
● B 라인 (12건)
● C 라인 (6건)
```

## 🎯 탭 네비게이션 개선

### 문제점
- 탭을 클릭했을 때 콘텐츠가 화면 아래에 있어서 보이지 않음
- 어떤 탭이 활성화되었는지 명확하지 않음
- 자동 스크롤 후 다시 위로 올라갈 수 없음

### ✅ 해결 방법

#### 0. **스크롤 영역 추가** 📜
```typescript
// ScrollArea 컴포넌트로 전체 페이지 감싸기
<div className="h-screen bg-gray-50 flex flex-col overflow-hidden">
  <ScrollArea className="flex-1">
    {/* 전체 콘텐츠 */}
  </ScrollArea>
</div>
```

**효과:**
- ✅ 우측에 스크롤바 표시
- ✅ 자유롭게 위/아래 스크롤 가능
- ✅ 전체 화면 높이 고정 (`h-screen`)
- ✅ 부드러운 스크롤 경험

#### 1. **자동 스크롤 (ScrollArea 연동)**
```typescript
const handleTabChange = (value: string) => {
  setSelectedTab(value);
  setTimeout(() => {
    if (tabContentRef.current) {
      // ScrollArea의 viewport 찾기
      const viewport = document.querySelector('[data-radix-scroll-area-viewport]');
      if (viewport) {
        const targetOffset = tabContentRef.current.offsetTop - 20; // 20px 여유
        viewport.scrollTo({ top: targetOffset, behavior: 'smooth' });
      }
    }
  }, 100);
};
```

**동작 순서:**
1. 탭 클릭
2. 0.1초 대기 (애니메이션 완료)
3. ScrollArea viewport 찾기
4. 타겟 위치로 부드럽게 스크롤
5. **여전히 수동 스크롤 가능!** ⬆️⬇️

#### 2. **탭 호버 & 활성화 효과**

**OEE 대시보드 탭:**
- 호버: 연한 파란색 배경 (`hover:bg-blue-50`)
- 활성화: 진한 파란색 배경 + 흰색 텍스트 (`bg-blue-500 text-white`)

**고장 분석 탭:**
- 호버: 연한 빨간색 배경 (`hover:bg-red-50`)
- 활성화: 진한 빨간색 배경 + 흰색 텍스트 (`bg-red-500 text-white`)

**점검 일정 탭:**
- 호버: 연한 초록색 배경 (`hover:bg-green-50`)
- 활성화: 진한 초록색 배경 + 흰색 텍스트 (`bg-green-500 text-white`)

#### 3. **부드러운 전환 애니메이션**
```css
transition-all duration-200
```

모든 색상 변화가 0.2초에 걸쳐 부드럽게 전환됩니다.

## 📈 라인별 고장 데이터 분석

### 현재 상황 (11월 기준)

| 라인 | 고장 건수 | 비율 | 평균 복구시간 | 주요 원인 | 우선순위 |
|------|-----------|------|---------------|-----------|----------|
| A 라인 | 5건 | 22% | 45분 | 베어링 마모 | 낮음 ✅ |
| **B 라인** | **12건** | **52%** | **128분** | **체인 장력, 전기 문제** | **긴급 🔴** |
| C 라인 | 6건 | 26% | 67분 | 센서 오류 | 중간 ⚠️ |

### 🔴 B 라인 긴급 조치 필요

**문제점:**
1. 전체 고장의 절반 이상 차지 (52%)
2. 복구 시간이 가장 김 (128분)
3. 다양한 원인 (체인 장력 + 전기)

**권장 조치:**
1. ⚙️ 체인 장력 조정 및 교체
2. 🔌 전기 시스템 점검
3. 📅 예방 보전 주기 단축 (월 → 주)
4. 👨‍🔧 전문 기술자 배치

### 월간 트렌드 분석

```
고장 발생 추이 (10월):
    ●
   ●●
  ●  ●
 ●    ●
●      ●●
01 05 08 12 15 18 22 25 28일
```

**패턴:**
- 초반(10/01~10/08): 안정적 (3건)
- 중반(10/12): 급증 (4건) ← B 라인 집중
- 후반(10/25~10/28): 개선 추세

## 💡 활용 팁

### 1. 빠른 현황 파악
1. **OEE 대시보드 탭** 클릭 → 전체 생산성 확인
2. **고장 분석 탭** 클릭 → 문제 라인 식별
3. **점검 일정 탭** 클릭 → 지연 점검 확인

### 2. 데이터 기반 의사결정
```
B 라인 OEE 72.1% (Fair) 
   ↓
고장 분석 → 12건 (52%)
   ↓
주요 원인: 체인 + 전기
   ↓
조치: 예방 보전 강화
   ↓
목표: OEE 85% 달성
```

### 3. 우선순위 결정
```
긴급 🔴 → B 라인 (OEE 72.1%, 고장 12건)
주의 ⚠️ → C 라인 (OEE 65.8%, 고장 6건)
유지 ✅ → A 라인 (OEE 87.3%, 고장 5건)
```

### 📜 스크롤 기능

**ScrollArea 컴포넌트 특징:**
- ✅ 깔끔한 우측 스크롤바
- ✅ 마우스 휠 스크롤
- ✅ 스크롤바 드래그
- ✅ 터치 스크롤 (모바일)
- ✅ 키보드 스크롤 (↑↓, Page Up/Down)

**자동 스크롤 + 수동 스크롤:**
```
탭 클릭 → 자동으로 콘텐츠 위치로 이동
        ↓
    언제든지 자유롭게 위/아래 스크롤 가능
        ↓
    다른 탭 클릭 → 다시 자동 스크롤
```

## 🚀 다음 업데이트 예정

1. **실시간 고장 알림**
   - 고장 발생 시 즉시 푸시 알림
   - 담당자 자동 배정

2. **AI 예측 분석**
   - 고장 패턴 학습
   - 예상 고장 시점 예측

3. **모바일 QR 스캔**
   - 설비별 고장 이력 조회
   - 현장에서 즉시 확인

4. **Supabase DB 연동**
   - 실제 데이터 저장/조회
   - 이력 관리 시스템
